# 修復想法趨勢圖表數量統計問題 - 回滾說明

## 問題描述

圖表顯示的數量與實際不符。12/7應該顯示累計總共5個想法，但只顯示2個。

## 修改內容

### 1. 改為累計統計（主要修改）
- **從每日數量改為累計數量**
- 每天顯示的是從最早日期到當前日期的累計想法數
- 例如：12/4有1個想法，12/5又新增2個，則12/5顯示累計3個

### 2. 添加詳細調試信息
- 添加範圍內所有想法的詳細列表輸出
- 添加填充統計資料時的詳細日誌
- 添加日期匹配和使用者匹配的驗證日誌

### 3. 改善錯誤處理
- 檢查日期是否在 allDates 中
- 檢查使用者是否在 members 列表中
- 輸出詳細的匹配狀態信息

## 回滾步驟

如果修改後系統無法啟動，請按照以下步驟回滾：

### 步驟 1：還原 API 文件

```bash
git checkout app/api/communities/[communityId]/idea-trend/route.ts
```

或者手動移除新增的調試代碼。

### 步驟 2：清除 Next.js 快取（可選）

```bash
Remove-Item -Path ".next" -Recurse -Force -ErrorAction SilentlyContinue
```

### 步驟 3：重新啟動

```bash
npm run dev
```

## 測試步驟

1. 重新啟動系統
2. 刷新瀏覽器頁面
3. 打開活動歷程頁面
4. 點擊「社群想法貢獻數量變化圖表」
5. 查看終端日誌，檢查：
   - 「範圍內所有想法總數」
   - 「範圍內想法詳細列表」
   - 「填充統計資料」的日誌

根據調試信息，我們可以定位問題所在。

## 修改的文件

- `app/api/communities/[communityId]/idea-trend/route.ts`

